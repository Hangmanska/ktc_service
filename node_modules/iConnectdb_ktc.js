var ipg_man = require('iPostgres_manconf.js');
var ms_config = 'master_config';
var ms_destina = ' ';


var config_db_tcp = {
   // "host": "127.0.0.1",
    "host": "61.91.14.253", 
    "port": "5432",
    "user": "postgres",
    "pws": "cloundserver@253",
    "dbname": "master_config",
    "ip_config_file": "http://203.154.243.61/"
}

var config_db_dev = {
    // "host": "127.0.0.1",
     "host": "139.59.110.252", 
     "port": "5432",
     "user": "postgres",
     "pws": "HGAF4CDUGfjcrLvc",
     "dbname": "gps_vt900",
     "ip_config_file": "http://203.154.243.61/"
 }
 



function get_configdb_tcp() {
    return config_db_tcp;
}
exports.get_configdb_tcp = get_configdb_tcp;

function get_configdb_dev() {
    return config_db_dev;
}
exports.get_configdb_dev = get_configdb_dev;

var sql = " ";
var para_db = { "ms_config": ms_config, "config_con": config_db_tcp, "sql": sql };


function im() {
    var db = { "db": config_db_web, "ipg_man": ipg_man, "para": para_db };
    return db;
}

exports.im = im;


function im2(config) {
    var db = { "db": config, "ipg_man": ipg_man, "para": para_db };
    return db;
}

exports.im2 = im2;



function get_rows(ipg, sql, cb) {
    ipg.para.sql = sql;
    ipg.para["config_con"] = ipg.db;
    ipg.ipg_man._query_ar(ipg.ipg_man, ipg.para, function (row) {
        //console.log(row);
        if (row.length > 0) {
            cb(row);
            return;
        } else {
            cb(0);
            return;
        }
    });
}
exports.get_rows = get_rows;

function excute(ipg, sql, cb) {
    ipg.para.sql = sql;
    ipg.para["config_con"] = ipg.db;
    ipg.ipg_man._iexcute(ipg.ipg_man, ipg.para, function (res) {
        //debugger;
        //console.log(r);
        if (res == 'ok') {
            cb('oK');
            return
        }
        else
        {
            console.log('excute ' + sql + ' ' + res)
            var msg_error = {'message':sql}
            cb(msg_error);
            return
        }
    });
}
exports.excute = excute;

function excute_cb(ipg, sql, cb) {
    ipg.para.sql = sql;
    ipg.para["config_con"] = ipg.db;
    ipg.ipg_man._iexcute_cb(ipg.ipg_man, ipg.para, function (res) {
        //debugger;
        //console.log(r);res.rows[0].id
        if (res.rows.length > 0) {
            cb(res.rows[0].id);
            return
        }
        else {
            console.log('excute ' + sql + ' ' + res)
            cb('ERROR');
            return
        }
    });
}
exports.excute_cb = excute_cb;





  