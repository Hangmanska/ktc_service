var ipg_man = require('iPostgres_manconf.js');
var ms_config = 'dbu_yazaki';
var ms_destina = ' ';


//config_db_web

//#region

var config_db_web =
{
    "host": "210.4.143.54",//"210.4.143.61", //"58.181.246.64", //"127.0.0.1", //
    "port": "5432",
    "user": "postgres",//"webapp",
    "pws": "",//"passw0rd",//"webtcp",
    "dbname": "Mobile_Master"//"master_config"
}

var config_db_tcp = {

    "host": "210.4.143.54",//"210.4.143.61", //"58.181.246.64", //"127.0.0.1", //
    "port": "5432",
    "user": "postgres",//"webapp",
    "pws": "",//"passw0rd",//"webtcp",
    "dbname": "Mobile_Master"//"master_config"
}

var config_db_global = {
    "host": "203.151.21.176",
    "port": "5432",
    "user": "postgres",
    "pws": "dbserver@176",
    "dbname": "dbu_master176"
}

var config_db_adminpoint = {
    "host": "203.151.21.176",
    "port": "5432",
    "user": "postgres",
    "pws": "dbserver@176",
    "dbname": "admin_point"
}

    //#endregion



function get_dbconfig_htt() {
    return {
        "host": "203.151.4.8",
        "port": "5432",
        "user": "rdteam",
        "pws": "rd@2015",
        "dbname": "HTT"
    };

    //return {
    //    "host": "210.4.143.54",
    //    "port": "5432",
    //    "user": "postgres",
    //    "pws": "",
    //    "dbname": "HTT"
    //};
}
exports.get_dbconfig_htt = get_dbconfig_htt;

function get_dbconfig_realtime() {
    return {
        "host": "203.151.4.8",
        "port": "5432",
        "user": "rdteam",
        "pws": "rd@2015",
        "dbname": "dbu_101279"
    };

    //return {
    //    "host": "210.4.143.54",
    //    "port": "5432",
    //    "user": "postgres",
    //    "pws": "",
    //    "dbname": "dbu_101279"
    //};
}
exports.get_dbconfig_realtime = get_dbconfig_realtime;



function get_configdb_web() {
    return config_db_web;
}
exports.get_configdb_web = get_configdb_web;

function get_configdb_tcp() {
    return config_db_tcp;
}
exports.get_configdb_tcp = get_configdb_tcp;

function get_configdb_global(){
    return config_db_global;
}
exports.get_configdb_global = get_configdb_global;

function get_configdb_adminpoint(){
    return config_db_adminpoint;
}
exports.get_configdb_adminpoint = get_configdb_adminpoint;

var sql = " ";
var para_db = { "ms_config": ms_config, "config_con": config_db_web, "sql": sql };


function im() {
    var db = { "db": config_db_web, "ipg_man": ipg_man, "para": para_db };
    return db;
}

exports.im = im;


function im2(config) {
    var db = { "db": config, "ipg_man": ipg_man, "para": para_db };
    return db;
}

exports.im2 = im2;


function get_rows(ipg, sql, cb) {
    ipg.para.sql = sql;
    ipg.para["config_con"] = ipg.db;
    ipg.ipg_man._query_ar(ipg.ipg_man, ipg.para, function (row) {
        //console.log(row);
        if (row.length > 0) {
            cb(row);
            return;
        } else {
            cb(0);
            return;
        }
    });
}
exports.get_rows = get_rows;

function excute(ipg, sql, cb) {
    ipg.para.sql = sql;
    ipg.para["config_con"] = ipg.db;
    ipg.ipg_man._iexcute(ipg.ipg_man, ipg.para, function (res) {
        //debugger;
        //console.log(r);
        if (res == 'ok') {
            cb('oK');
            return
        } else {
            console.log('excute ' + sql + ' ' + res)
            cb('ERROR');
            return
        }
    });
}
exports.excute = excute;